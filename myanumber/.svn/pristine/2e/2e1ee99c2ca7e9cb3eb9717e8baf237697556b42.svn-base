using System;
using System.Collections.Generic;
using System.Globalization;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Data;
using myanumber.Entities;
using Microsoft.Phone.Info;

namespace myanumber.Converters
{
    public class ConvertMMToPixels : IValueConverter
    {
        private static int oneCM = 10;
        private static double oneInch = 2.54;

        public ConvertMMToPixels()
        {

        }

        #region IValueConverter Members

        public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
        {
            DeviceDetails deviceDetails;
            deviceDetails = GetPPIScaleForCurrentDevice();

            double valueInMM = (double)value;
            return ConvertIntoPixels(valueInMM, deviceDetails.PPI, deviceDetails.Scale);


           // return mm * 2;
        }

        public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
        {
            throw new NotImplementedException();
        }

        #endregion


        private double ConvertIntoPixels(double valueInMM, double PPI, double Scale)
        {
            double valueInInches = valueInMM / oneCM / oneInch;
            return valueInInches * PPI / Scale;
        }

        private DeviceDetails GetPPIScaleForCurrentDevice()
        {
            DeviceDetails deviceDetails = new DeviceDetails();
            //string deviceName = "RM-892_im-india_216";         
            string deviceName = DeviceStatus.DeviceName;
            string deviceValue = deviceName.Split('_')[0];

            switch (deviceValue)
            {
                //Device Names fror Nokia Lumia 925
                case "RM-892":
                case "RM-893":
                case "RM-910":
                    deviceDetails.PPI = 334;
                    deviceDetails.Scale = 1.6;
                    break;
                //Device Names for Nokia Lumia 1520
                case "RM-937":
                case "RM-940":
                case "RM-939":
                    deviceDetails.PPI = 368;
                    deviceDetails.Scale = 2.25;
                    break;
                default:
                    deviceDetails.PPI = 0;
                    deviceDetails.Scale = 0;
                    break;
            }

    return deviceDetails;
            
        }
    }
}

